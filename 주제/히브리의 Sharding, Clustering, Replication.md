## 주제( DB아키텍처 종류)
- 히브리의 Sharding, Clustering, Replication
- <https://jordy-torvalds.tistory.com/94> (참고)
- <https://www.youtube.com/watch?v=y42TXZKFfqQ> (영상)
### 주제선택이유
읽게된 계기 클러스터링과, 세션 클러스터링 이러한 용어가 나오길레 궁금해서 영상을 시청했다. <br>
그러다 먼저 클러스터링에 대해서 알아야겠다는 생각에 보게되었다.

### 클러스터링이란?
여러대의 컴퓨터를 연결한 병렬 시스템을 말합니다. <br>
여러대의 컴퓨터를 서로 연결하여 마치 하나의 컴퓨터처럼 사용하는 것을 클러스터라고 합니다.<br>
서로 통신이 가능하며 업무를 분담해서 수행하게 됩니다. 이러한 생각을 통해서 DB클러스터링이 나오게 되었다.<br>

### DB클러스터링이 나오게된 이유
<img src="https://user-images.githubusercontent.com/79621675/153740054-ae8cd7fe-be1b-4544-87b4-317032c4b732.png" width=400/> <br>
데이터베이스 서버가 죽으면 어떻게 하지? 라는 이유에서 나왔다
가장 간단한 방식은 데이터 베이스 서버를 여러개로 만들자(스토리지는 그대로 두고 서버만)


### DB클러스터링
기본적인 DB 구축은 1개의 서버로 하나의 DB를 구축해서 운용하는 형태가 많다. 
그러나 여러가지 이유로 하나의 DB를 여러개의 서버가 나눠서 처리하도록 하는 형태가 늘어나고 있다.
여기서 DB 클러스터라 함은 하나의 DB을 복수개의 서버(또는 가상 서버)상에 구축되는 경우를 지칭한다.
DB 클러스터와 비슷한 형태로 복수개의 독립된 DB가 서러 연계되는 경우가 있다. 


### 클러스터링 종류

#### Active-Active
<img src="https://user-images.githubusercontent.com/79621675/153740196-e96fc020-d849-44d5-8856-e9a88da48d69.png" width=400/> <br>
<pre>
서버 하나가 죽어도 다른 서버가 역할을 바로 수행하여 중단되는 시간이 없다. 
같이 사용되어 CPU와 메모리 이용률을 올릴 수 있다. (성능 향상)
단점으로는 저장소 하나를 공유하면 병목현상이 발생될 수 있다.
비용이 비싸다.

병목현상 : 전체 시스템이 성능이나 용량이 하나의 구성요소르 인해 제한을 받는 현상
</pre>

#### Active - StandBy 
<img src="https://user-images.githubusercontent.com/79621675/153740290-229a775f-fe73-414a-b815-d281dec117b9.png" width=400/> <br>
<pre>
하나의 서버만 동작하다가 Active가 죽었을 때 stand by서버를 실행시켜 전환하는 방식이다
장점으로는 비용이 저렴하다. 그런데 단점은 Active가 죽었을 때 전환시 시간이 오래 걸린다.(이거는 부하테스트하면 이걸이용하는방식 실험해보고싶다)
(수십 초~ 수십 분)
</pre>


#### 리플리케이션(Replication)
<img src="https://user-images.githubusercontent.com/79621675/153740394-1b1a133a-f928-4a2e-832b-a04355acb962.png" width=400/> <br>
<pre>
저장된 데이터가 손실되면 어떻게 하지? 라는생각에서 나온것이다.
서버가 죽은거는 클러스터링으로 해결하지만 스토리지는 하나이기떄문에 위의 문제를 해결하기 하기위해서 Replication이 나왔다.
기본적인구성은 Master와 Slave db를 나눈다
더 나아가 Slave db를 백업용으로만 안사용하고 부하 분산 용도로 사용하기도 한다 (read용도로만 = select)
</pre>

#### 샤딩
<img src="https://user-images.githubusercontent.com/79621675/153740511-04bf00e8-b264-44c5-8c2d-2dfef39f3724.png" width=400/> <br>
<pre>
데이터가 쌓여서 너무 많아서 검색이 느린데 더 빠르게 할 수 있는 방법은 없을까? 라는 문제 (데이터 검색을 빠르게하기위해서)
다만 아쉬운 점은 여전히 존재하는데, 만약에 테이블에 데이터 자체가 엄청나게 많다고 가정하겠습니다.
그러면 Slave DB 서버를 N 대로 늘려도 원하는 데이터를 테이블로 부터 찾는데 많은 시간이 소요될 것 입니다.
테이블을 나눠서 검색하자!
샤딩은 분산된 db에 data를 어떻게 잘 분산시켜서 저장할 것인가?
분산된 db에서 data를 어떻게 읽을 것인가에 따라 알고리즘이 여러개다
shard key결정 방식에 따라 Sharding 방법이 나뉜다.
</pre>

### 궁금증
- 클러스터링과 리플리케이션 샤딩은 서로 다르다 db구조의 종류들인것같다
- DB서버는 우리가 사용하는것을 예로들면무엇인가? 
- DB스토리지는 내가 사용한것을 예로들면무엇인가?
- Master slave이렇게 하는방법 어케하는거지? 
